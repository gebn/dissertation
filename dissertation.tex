\documentclass[12pt]{bhamdissertation}

%load any additional packages
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage[UKenglish]{babel}
\usepackage[autostyle]{csquotes}
\usepackage[nodayofweek]{datetime}
\usepackage{pdflscape}
\usepackage{titlesec}
\usepackage[backend=biber,bibencoding=utf8,style=ieee,sorting=none]{biblatex}
\usepackage[hidelinks]{hyperref}
\usepackage[toc,page]{appendix}
\usepackage{lipsum}
\usepackage{enumitem}

\titleformat{\paragraph}{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

%input macros (i.e. write your own macros file called mymacros.tex 
%and uncomment the next line)
%\include{mymacros}

\title{Equaliser}
\author{George Brighton}             %your name
\college{School of Computer Science}  %your college
\degree{MEng Computer Science \& Software Engineering}     %the degree

\addbibresource{references.bib}
\bibliography{references}        %use a bibtex bibliography file refs.bib
%\bibliographystyle{plain}  %use the plain bibliography style

%end the preamble and start the document
\begin{document}

%this baselineskip gives sufficient line spacing for an examiner to easily
%markup the thesis with comments
\baselineskip=18pt plus1pt

%set the number of sectioning levels that get number and appear in the contents
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{1}

\maketitle                  % create a title page from the preamble info

\begin{romanpages}          % start roman page numbering

\tableofcontents

% TODO should be possible to move contents line to class file
% http://tex.stackexchange.com/a/258973 for why 3 things are needed
\cleardoublepage\phantomsection\addcontentsline{toc}{chapter}{Abstract}
\begin{abstract}
\lipsum[1-1] % TODO
\end{abstract}

\cleardoublepage\phantomsection\addcontentsline{toc}{chapter}{Acknowledgements}
\begin{acknowledgements}
\lipsum[2-2] % TODO
\end{acknowledgements}

\end{romanpages}            % end roman page numbering

\chapter{Mining properties of existing systems}

The insights in this section are based on a whitepaper \autocite{B17} I produced earlier in the project on the current state of the ticketing industry. It is clear that there is currently no complete solution to the problem of touting. This section qualitatively analyses the research in the paper to identify attributes that are conducive and resistant to touting, and other notable features whose absence or presence would enhance a future ticket distribution system.

\section{Single Distributor}

Event organisers using multiple distributors is clearly an issue, as it allows any protections offered by a system to be circumvented by a vulnerable one. Malicious actors would simply use the latter. DICE identified this issue, and plugged the hole by making themselves the exclusive distributor of tickets for a given event. If two systems existed in future that were secure in isolation, using them together could introduce potential issues or opportunities for confusion, so in practice, one distributor should be used.

Box offices are inherently at odds with this observation on several levels. If a venue's box office is to be its sole distributor of tickets, using a separate system for each venue would be a great inconvenience to fans and event organisers. If we make the reasonable assumption that a box office alone cannot handle the demand for tickets, then another distributor is needed, which means the box office must be removed to maintain the single source. Unfortunately, from a touting prevention perspective, box offices are pointless at best, and a subversive side-channel attack at worst.

\subsection{Conflict of Interest}

Given the rule of a sole distributor, companies will compete to win the business of being that distributor. To differentiate themselves, these firms can highlight the rate at which they sell tickets, and the total number of tickets sold, which may conflict with ensuring those tickets go to genuine fans. This can only be solved by removing all metrics related to the rate of ticket sales from a distributor's fee calculation. They should receive a fixed payment that is agreed in advance and independent of the number of tickets sold. Promotion must be distinct from processing.

\section{Ticket Transferability}

Paper tickets are inherently broken, as it is impossible to prevent a physical object from being transferred between two parties. Adding a name which is rarely validated does nothing to improve this situation. Paperless tickets were ostensibly introduced to combat this. The photo ID was an important improvement, however as already discussed, only the purchaser's identity is validated (if checked at all), leaving 3-7 tickets per credit card available for touting, and a tidy profit. Unfortunately, DICE is ineffective against touts in this regard. If an individual buys several tickets, there is nothing tying these to individuals, and so they can be resold.

Automation of the ticket purchasing process attacks the same vulnerability, and the reCAPTCHA test used by Ticketmaster and others is duct tape over a deeper problem. A system that is vulnerable to bots is also vulnerable to humans, if to a lesser extent. Limiting the number of tickets that can be purchased per transaction is another smoking gun, and has only resulted in touts using multiple credit cards. The only way to truly fix these two issues is to address the transferability problem.

The entire reselling industry only exists because tickets are, in practice, transferable. Twickets is well-intentioned, but does not address the root of the problem. It should not be possible for tickets to go near a secondary ticketing site, as touts are under no obligation to use a benevolent one. Therefore, the solution of for an identity to be tied to a ticket, and validated on entry to the venue. The validation is key; no amount of security will help if it is looking the other way.

\subsection{Reallocation}

Ticket reallocation occurs when an individual with a ticket wants to return it for a refund. DICE made the key design decision to not allow the purchaser any say in who returned tickets go to. By simply returning tickets to a pool, a tout cannot resell a ticket, as they have no control over who receives it. In a system that identified every ticketholder, this would be a useful property, however unfortunately, due to the aforementioned issue with only validating the purchaser's identity, it is redundant for DICE. As tickets are nameless, a tout can replace those he lets in as many times as he likes before the event. 

\section{Notable Features}

In addition to properties directly related to the prevention of touting, it is useful to note ways in which these systems are either suboptimal or successful.

\subsection{Purchase Timeout}

The concept of entering a minimal set of details, then having a fixed amount of time to complete the purchase is very useful. It levels the playing field, meaning people are not pelanised for being slow at typing or mis-entering payment information. It also reduces the amount of time users are under pressure for, without hindering competition, leading to a more pleasant ordering experience.

\subsection{Stability}

The inability for ticket websites to stay available during large ticket releases appears to have become something of a requirement. Since the introduction of cloud computing several years ago, there has been no excuse for being unable to handle spikes in demand. Any ticket vendor that meets the seemingly straightforward criterion of staying online during a large release would already be ahead of the competition.

\subsection{Group Entrance}

Due to the way paperless tickets work, all members of a group must enter the venue at once. While not broken entirely, this can cause serious inconvenience if one person in a large group is running late. A secondary issue here is that of gifted tickets. As the payment card is effectively the ticket, it is not possible to buy tickets for two friends to attend an event on their own. Each person in a group should be able to enter the venue in their own right. This should not be a challenging requirement if each ticket is individually tied to a person.

\subsection{Fees}

Fees are one of the most disliked properties of existing systems, yet one of the easiest to fix. It is clear that current fees are not related to their label, the most obvious example being Ticketmaster charging for delivery of tickets sent via email. Customers know they are used to maximise revenue while keeping the perceived price of tickets as low as possible.

Removing these fees is obviously the ideal, but a more pragmatic solution would be to include them in the ticket price, so buyers see a single value. This would be more popular with customers, as it is more honest. The increase in face value will not put people off or leave a sour taste nearly as much as a list of questionable charges. DICE got this right by showing no fees to purchasers, and buyer perception is amongst the highest of any distributor.

\chapter{Requirements}

Analysis of the current state of the art with regard to ticket touting provided a ruler by which to measure any new ticket system. By flipping this on its head, I hoped to use these metrics to design core requirements for a perfect system. Many more requirements would emerge during the practical design, however they were not perceived in advance, simply because no system so far was able to offer a complete solution to ticket touting.

\section{Functional}

\begin{enumerate}
    \item Users should be able to return a ticket for a refund.
    \begin{enumerate}
        \item This should be permitted outright, or only if the system can reallocate those tickets to someone in the waiting list, so no revenue is lost.
    \end{enumerate}
    \item Direct ticket transfers between individuals should not be permitted. User A should not be able to give their ticket to User B, as we cannot prevent money from changing hands outside of the application.
    \begin{enumerate}
        \item Unwanted or refunded tickets should be returned to a pool of available tickets.
    \end{enumerate}
    \item Users should only have to enter a minimum number of details before their tickets are reserved, or they enter the waiting list.
    \item Venue staff must be able to revalidate a ticket and verify an attendee's identity inside the venue.
    \item Two-factor authentication should be mandatory for login.
\end{enumerate}

\subsection{Groups}

\begin{enumerate}[resume]
    \item Each ticket in a group booking must be tied to a registered user at the point of order.
    \item Each attendee in a group should be able to enter the venue individually on their own merit.
    \item A group leader must be able to specify that some members in a group should pay for their own tickets.
\end{enumerate}

\subsection{Gifts}

\begin{enumerate}[resume]
    \item A user should be able to purchase tickets for others.
    \item They should be able to individually specify when those tickets should become visible to the giftees.
    \item The gifter should be able to attach a message to each gifted ticket that will be displayed when it is revealed to the giftee.
    \item The gifter can refund a ticket before it is released to the giftee, after which only the giftee can refund it.
    \item The original purchaser is always refunded the cost of the ticket, even if a giftee initiates a refund.
\end{enumerate}

\section{Non-functional}

\begin{enumerate}[resume]
    \item The system must partner with event organisers to be the one and only distributor of tickets. Only tickets issued by the system and verified by staff upon entry should be accepted.
    \item Fees should be included in the cost of the ticket.
    \item The ordering system should be able to support 500,000 simultaneous users.
    \item No subsystem should have a single point of failure.
\end{enumerate}

\chapter{Practical Design}

My task was now to design a system, using the requirements in the previous chapter as non-negotiables. Even with a set of requirements, it is difficult to know where to start designing a system. Ticket distribution is not particularly large, but the human aspect meant there was nowhere to hide: if the design was flawed, it would be no better than any other solution on the market.

\section{Entrance}

I decided to start by focusing on the process by which ticketholders would gain access to a venue, as controlling this is ultimately the main purpose of the system. If at all possible, I wanted this to be completely automatic, with no human verification needed. This would remove any chance of human error or corruption, while making my solution more attractive to venues, who would not have to hire as many staff.

To make this work, I knew I would have to produce a token that could only be used by its rightful owner to enter a venue. At first, I considered payment cards, for the reason that many experts have already put a lot of effort into making these secure. If possible, I wanted to stand on their shoulders. Unfortunately, this had two key problems.

\begin{enumerate}
    \item In a group scenario, only the original purchaser necessarily has a payment card on file. As the system would not know about the cards of anyone else in the booking, they would have to enter the venue together, which was a direct violation of the requirements.
    \item Requiring each individual to have a payment card on file is too draconian. Not everyone going to an Ed Sheeran concert is old enough to own a credit card, and it is unreasonable to require parents to give them to their children - and even then, there is only one copy of the card.
\end{enumerate}

This was clearly unworkable. By going through this process, I knew this token had to be something that everyone would have, preferably something they already had on them anyway for convenience. The most obvious choice was a mobile phone, which has the added benefit that I could put arbitrary data on it to act as a ticket. It is trivial to send this data via the internet, and as phones have a screen, they can display this data however I liked, which could be the same as existing ticket barcodes so no changes to barriers at venues would be required.

I quickly thought of a handful of ways that a barcode could be displayed on a phone securely. It could be a hash of some key material unique to the user, such as an X.509 private key. An intermediate certificate authority could be created for each event, that would sign requests for tickets. If a refund was initiated, the ticket could be revoked and so on. To make tickets difficult to copy, the key material could be hashed with a timestamp every 30 seconds, and an animation could be displayed to make it difficult to screenshot. This was not perfect, but I was reasonably confident of being able to tie a ticket to a phone.

Unfortunately, it was all for nothing. It is one thing to tie a ticket to a phone, but it is quite another to ensure the person who shows up with a phone is its true owner. Any number of security features is irrelevant if a tout can simply give a phone containing a ticket to someone else. Indeed, touting is so lucrative that one could quite easily buy 10 or 100 pay-as-you-go phones and include the cost of the phone in the price of the ticket, and still make a tidy profit. This problem turned out to be much harder than initially thought.

At first, I considered forcing the user to enter a passcode, however I realised the challenge cannot be based around knowledge, as that can be communicated to someone else. Similar to the ideas behind two-factor authentication, it requires something you have, not something you know. I then looked into biometrics, for example using a fingerprint to reveal the barcode for a few seconds at the barrier. This had four issues.

\begin{enumerate}
    \item Although becoming more prevalent, many phones are not equipped with fingerprint readers. Relying on them would require a two-lane system where those with less-able phones would queue. Any malicious actors would simply use the weaker option.
    \item Even amongst phones with the technology, they do not always function correctly. A 1\% mis-read rate equates to 900 people in Wembley Stadium.
    \item The phone is literally in the hands of the attacker, and biometrics fundamentally trust the phone's technology. Ideally, we only want to have to trust what is under our control.
    \item On iOS, applications receive a boolean response to a fingerprint scan. They cannot identify who a fingerprint belongs to, so an attacker could simply register a fingerprint of whoever bought a touted ticket.
\end{enumerate}

I decided the technology was neither secure nor reliable enough to use. I also considered photographs, which could be recognised at the barrier, but again the technology is not accurate enough.

Disheartened that phones alone did not seem to provide a secure option, I changed to using it in combination with another piece of identity. I briefly revisted credit cards as a possible option, particularly because they are not something given to a stranger lightly, but at the same time touts are known to own many cards, and could make buyers pay a deposit for the duration of an event. Passports seemed to be more promising, however they are almost too valuable. I found it difficult to come up with a document that was private enough to be worth validating, but not so private as to worry genuine purchasers. Thefts are common at concerts, and would be even more so if thieves knew everyone in attentance had a credit card, smartphone and passport on them.

Photocards and Oyster cards initially seemed to be an answer. They are difficult enough to get hold of and a pain to replace, however they are bespoke to each country (in the case of Oyster, a single city), and sometimes genuine copies look fake. The real issue was they are trivially easy to photocopy, and many countries, such as Germany, do not allow non-govermental organisations to use national identity cards [CITE]. Any automated system is vulnerable to forgeries. Without a human present, to check each document, we cannot really do anything about this.

\subsection{Manual Verification}

Regretfully, I resigned to having humans present at the turnstiles to verify attendees. Passport gates at the UK border still require a human to confirm access. If even these are not entirely automatic, when in complete control of the physical token (the passport), the chances are I would not be able to come up with a secure solution either. This was a disappointment, but no worse than the current paperless system.

To reduce the likelihood of staff intimidation, it could be done in a similar fashion to passport gates, where staff are kept physically separate from the people they are allowing through. To limit potential issues of corruption, where a member of staff lets their friends through, two controllers could manage several lanes, with individual requests for entry being randomised between them, so there was no guarantee of being confirmed by a single person. Regardless, this has the benefit of not requiring one employee per lane into the venue, so the increase in cost is not as substantial as I thought.

My attention then turned back to the exact checks to perform. Photos were showing the most promise, and humans are good at comparing faces, so I revisited this idea. I envisaged a system where users would upload a photograph of themself during registration, which would be shown alongside the barcode. A human would then ensure the person in front of them matched, and allow them through.

Photos would have to be vetted to make sure they were appropriate, however this could be done automatically to some extent. Facial recognition could be used to verify that one and only one face appeared in the image, and it was of appropriate size. Ultimately, such a mechanism may need a human to confirm, however this would only have to be done once per person. Of course, the photo would have to be verified before any tickets were allocated, and could not be changed at will. Any updates would have to be approved to ensure the person in the photo was the same. Ticketmaster has a similar verification system for the case where the payment card expires before an event.

I was happy with all of this, apart from the photo existing on the user's phone, which felt dangerous; as already mentioned, the phone is in the hands of Mallory. To remove this dependency, instead of showing the photo on the phone, when the barcode was scanned, the system would show the photograph on file next to the attendee, then the member of staff would simply accept or reject entry. This had the nice property that all ticket material on the phone need no longer be secure, as even armed with another person's ticket, it would not be possible to pass the visual check (identical twins notwithstanding, but they are unlikely to tout to each other). Not relying on any phone security is a nice assumption to be able to make. There was no longer any value in screenshotting someone else's phone, so I would not have to put lots of effort into trying to prevent this.

The outcome was realising the phone is effectively reduced to a pointer to a person, like a user ID. To remove the possibility of attackers iterating through all users, finding people who looked similar to each other, the token could be long and random, so it is infeasible to explore the space of all users.

Therefore, in summary, when a user registers, they upload a clear photo of themselves. They have a single ``ticket'' for all events, which is unique to them. Upon scanning this data at the ticket barrier, their profile is retrieved, and automatically checked to see whether they have a valid ticket for the event. If they do, a member of staff compares the photo on file with the person who has shown up. If they match, the person is allowed in. A given person is only allowed in once. As tickets in themselves are useless for entry, they cannot be touted. Even changing the barcode is unlikely to point to another user, and even if it does collide, the chances are astronomically small that they will look like the attacker, or have a ticket. Tokens could also be regenerated regularly completely automatically, without users noticing.

\section{The Event Hierarchy}

At this stage, I started confusing myself. ``event'' could refer to ``Wimbledon'', ``Wimbledon 2017'', ``Wimbledon 2017, Day 1'', or ``Wimbledon 2017, Day 1, Centre Court''. Some more accurate vocabulary was needed to avoid ambiguity.

\begin{description}[style=nextline]
    \item[Tiers] A type of ticket for a single performance, e.g. \textit{Standing}, \textit{Stalls}, or \textit{Debentures}. A tier has an associated price, availability and returns policy (always, or only if the ticket can be reallocated). It may or may not have a seat allocation.
    \item[Fixtures] Generally, a fixture will match the duration of a ticket's validity, e.g. \textit{UKNOF 38} or \textit{Wimbledon 2017, Day 4, Centre Court}. Fixtures have a designated venue, and one or more tiers.
    \item[Series] Fixtures combine to form series, which are collections of experiences, usually over no more than a couple of months. Examples include \textit{Glastonbury 2017}, \textit{Derren Brown: Svengali}, and \textit{Ed Sheeran: X Tour}. Their start and end dates can be derived from the fixtures within them.
    \item[Headlines] I considered this final tier to contain series, however they were ultimately not implemented, in favour of tags instead. Examples would have been \textit{Wimbledon} and \textit{6 Nations}.
\end{description}

I wanted the system to be able to handle as many types of event as possible, so generic terminology was needed. However, it need not be exhaustive. If a new type of event that does not fit the above structure came along, I decided it could adapt and, if necessary, abuse it to fix its needs. Ticketmaster is a frequent culprit in this regard.

\section{Etymology}

I was now beginning to see the system's role more clearly, and decided to call it \textit{Equaliser}. This had the nice property of applying to many different events, similar to the system, e.g. a mixing equaliser in the context of music, or an equaliser in a tennis match. I also saw it as a way f getting equal with touts.

%now enable appendix numbering format and include any appendices
\appendix
\begin{appendices}

%\chapter{Proposal}
%Here's my project proposal.

\chapter{API Reference}
\label{appendix:api_reference}

Methods, parameters and return values for the Equaliser API.
% TODO

\chapter{Source Archive}
\label{appendix:source_archive}

Here's what's included and how to run it.
% TODO

\end{appendices}

\cleardoublepage  % http://tex.stackexchange.com/a/23503
\addcontentsline{toc}{chapter}{Bibliography}
%\nocite{*} % can add back in to trivially increase page count
\printbibliography

\end{document}
